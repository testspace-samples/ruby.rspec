language: ruby
rvm:
  - 2.1.1

before_install:
  # Install Testspace Runner
  - ./testspace_install.sh
  - export PATH="${HOME}/testspace:${PATH}"
  - gem install bundler
  - "export DISPLAY=:99.0"
  - "sh -e /etc/init.d/xvfb start"
  - sleep 3 # give xvfb some time to start

script:
  - COVERAGE=true bundle exec rake ci:setup:rspec spec

  # Publish Test Results along with Coverage
  - testspace publish [Tests]spec/reports/*.xml{spec} coverage/coverage.xml ${TESTSPACE_URL}
